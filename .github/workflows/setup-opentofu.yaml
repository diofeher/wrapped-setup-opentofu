on: push

jobs:
  tofu-plan-apply:
    name: Tofu Plan and Apply
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v6
      - name: Setup OpenTofu
        uses: opentofu/setup-opentofu@v1.0.6
        with:
          tofu_wrapper: true
      - name: Tofu Init
        run: tofu init
      - name: Tofu Plan
        id: plan
        run: tofu plan
      - run: echo ${{ steps.plan.outputs.stdout }}
      - run: echo ${{ steps.plan.outputs.stderr }}
      - run: echo ${{ steps.plan.outputs.exitcode }}
      - name: Tofu Apply
        run: tofu apply -auto-approve
